// let places=[
//     { key : "Islamabad" , Temperature : "35° C" },
//     { key : "Rawalpindi" , Temperature : "32° C" },
//     { key : "Karachi" , Temperature : "40° C" },
//     { key : "Lahore" , Temperature : "45° C" },
// ]

let places = [
    {
<<<<<<< HEAD
        key: "Islamabad",
        TimeSlots: [
            { Hour: "00:00", Temp: "35° C" },
            { Hour: "01:00", Temp: "34° C" },
            { Hour: "02:00", Temp: "33° C" },
            { Hour: "03:00", Temp: "32° C" },
            { Hour: "04:00", Temp: "31° C" },
            { Hour: "05:00", Temp: "30° C" },
            { Hour: "06:00", Temp: "30° C" },
            { Hour: "07:00", Temp: "31° C" },
            { Hour: "08:00", Temp: "32° C" },
            { Hour: "09:00", Temp: "34° C" },
            { Hour: "10:00", Temp: "35° C" },
            { Hour: "11:00", Temp: "36° C" },
            { Hour: "12:00", Temp: "37° C" },
            { Hour: "13:00", Temp: "38° C" },
            { Hour: "14:00", Temp: "39° C" },
            { Hour: "15:00", Temp: "40° C" },
            { Hour: "16:00", Temp: "39° C" },
            { Hour: "17:00", Temp: "38° C" },
            { Hour: "18:00", Temp: "37° C" },
            { Hour: "19:00", Temp: "36° C" },
            { Hour: "20:00", Temp: "35° C" },
            { Hour: "21:00", Temp: "34° C" },
            { Hour: "22:00", Temp: "33° C" },
            { Hour: "23:00", Temp: "32° C" }
        ]
    },
    {
        key: "Rawalpindi",
        TimeSlots: [
            { Hour: "00:00", Temp: "32° C" },
            { Hour: "01:00", Temp: "31° C" },
            { Hour: "02:00", Temp: "30° C" },
            { Hour: "03:00", Temp: "29° C" },
            { Hour: "04:00", Temp: "28° C" },
            { Hour: "05:00", Temp: "27° C" },
            { Hour: "06:00", Temp: "27° C" },
            { Hour: "07:00", Temp: "28° C" },
            { Hour: "08:00", Temp: "29° C" },
            { Hour: "09:00", Temp: "30° C" },
            { Hour: "10:00", Temp: "31° C" },
            { Hour: "11:00", Temp: "32° C" },
            { Hour: "12:00", Temp: "33° C" },
            { Hour: "13:00", Temp: "34° C" },
            { Hour: "14:00", Temp: "35° C" },
            { Hour: "15:00", Temp: "36° C" },
            { Hour: "16:00", Temp: "35° C" },
            { Hour: "17:00", Temp: "34° C" },
            { Hour: "18:00", Temp: "33° C" },
            { Hour: "19:00", Temp: "32° C" },
            { Hour: "20:00", Temp: "31° C" },
            { Hour: "21:00", Temp: "30° C" },
            { Hour: "22:00", Temp: "29° C" },
            { Hour: "23:00", Temp: "28° C" }
        ]
    },
    {
        key: "Karachi",
        TimeSlots: [
            { Hour: "00:00", Temp: "40° C" },
            { Hour: "01:00", Temp: "39° C" },
            { Hour: "02:00", Temp: "38° C" },
            { Hour: "03:00", Temp: "37° C" },
            { Hour: "04:00", Temp: "36° C" },
            { Hour: "05:00", Temp: "35° C" },
            { Hour: "06:00", Temp: "35° C" },
            { Hour: "07:00", Temp: "36° C" },
            { Hour: "08:00", Temp: "37° C" },
            { Hour: "09:00", Temp: "38° C" },
            { Hour: "10:00", Temp: "39° C" },
            { Hour: "11:00", Temp: "40° C" },
            { Hour: "12:00", Temp: "41° C" },
            { Hour: "13:00", Temp: "42° C" },
            { Hour: "14:00", Temp: "43° C" },
            { Hour: "15:00", Temp: "44° C" },
            { Hour: "16:00", Temp: "43° C" },
            { Hour: "17:00", Temp: "42° C" },
            { Hour: "18:00", Temp: "41° C" },
            { Hour: "19:00", Temp: "40° C" },
            { Hour: "20:00", Temp: "39° C" },
            { Hour: "21:00", Temp: "38° C" },
            { Hour: "22:00", Temp: "37° C" },
            { Hour: "23:00", Temp: "36° C" }
        ]
    },
    {
        key: "Lahore",
        TimeSlots: [
            { Hour: "00:00", Temp: "45° C" },
            { Hour: "01:00", Temp: "44° C" },
            { Hour: "02:00", Temp: "43° C" },
            { Hour: "03:00", Temp: "42° C" },
            { Hour: "04:00", Temp: "41° C" },
            { Hour: "05:00", Temp: "40° C" },
            { Hour: "06:00", Temp: "40° C" },
            { Hour: "07:00", Temp: "41° C" },
            { Hour: "08:00", Temp: "42° C" },
            { Hour: "09:00", Temp: "43° C" },
            { Hour: "10:00", Temp: "44° C" },
            { Hour: "11:00", Temp: "45° C" },
            { Hour: "12:00", Temp: "46° C" },
            { Hour: "13:00", Temp: "47° C" },
            { Hour: "14:00", Temp: "48° C" },
            { Hour: "15:00", Temp: "49° C" },
            { Hour: "16:00", Temp: "48° C" },
            { Hour: "17:00", Temp: "47° C" },
            { Hour: "18:00", Temp: "46° C" },
            { Hour: "19:00", Temp: "45° C" },
            { Hour: "20:00", Temp: "44° C" },
            { Hour: "21:00", Temp: "43° C" },
            { Hour: "22:00", Temp: "42° C" },
            { Hour: "23:00", Temp: "41° C" }
        ]
=======
        key: "Islamabad"
    },
    {
        key: "Rawalpindi"
    },
    {
        key: "Karachi"
    },
    {
        key: "Lahore"
>>>>>>> 1aac80a (Weather On React Added)
    }
];

const placeTemperature = document.querySelectorAll(".temperature")
const placeHour = document.querySelectorAll(".hour")
// placeTemperature.forEach(element => {
//     console.log(element.innerHTML)
//     element.onclick = () => {InputNumber(element)};
// });


let temperatureDiv = document.getElementById("TemperatureDiv");
temperatureDiv.style.visibility = 'hidden';

let currentTemperature = document.getElementById("currentTemperature");

function AddTimeSlots ()
{
    for (let i = 0; i < 7; i++) 
    {
        
        let TimeSlot = document.getElementById("TimeSlots"+(i+1));
        for (let k = 0; k < 24; k++) 
        {
            let hourDay = document.createElement("div")
            hourDay.classList.add("hourDay"+(i+1));
            let temperatureDay = document.createElement("div")
            temperatureDay.classList.add("temperatureDay"+(i+1));
            temperatureDay.style.display = "flex";
            temperatureDay.style.textAlign = "center";
            temperatureDay.style.flexDirection = "row";
            let hourIcon = document.createElement("img")
            hourIcon.classList.add("hourIcon"+(i+1)); 
            hourIcon.src = "//cdn.weatherapi.com/weather/64x64/day/176.png"; // Set the source for the image
            hourIcon.alt = "Hour Icon"; 
            temperatureDay.appendChild(hourIcon);
            TimeSlot.append(hourDay);
            TimeSlot.append(temperatureDay);
            
            TimeSlot.style.display='none'
        }
       
    }
  
}

AddTimeSlots();

function ShowHideTimeSlots(dayIndex)
{
    let TimeSlot = document.getElementById("TimeSlots"+dayIndex);
    if( TimeSlot.style.display =='none')
    {
        TimeSlot.style.display = 'grid'
    }
    else
    {
        TimeSlot.style.display ='none'
    }
}


let dropDown = document.getElementById("DropDown");
let placeName = document.getElementById("placeName");
//let placeTemperature = document.getElementById("temperature");
var Webflow = Webflow || [];
  Webflow.push(function () {
    document.getElementById('DropDown').classList.add('w--open');
  });

let searchBar = document.getElementById("searchBar");
searchBar.oninput =() => 
{
    let text = searchBar.value + "";
    text = text.toUpperCase();
    text = text.trim();    
    let matchedValues = [];
    for (let index = 0; index < places.length; index++) 
    {
        let currentPlace = places[index];

        let matched = true;
        if(text.length > 0)
        {   
            for (let k = 0; k < text.length; k++) 
            {
                let placeKey = currentPlace.key[k];
                if(text[k] != placeKey.toUpperCase())
                {
                    matched = false;
                    break;
                }            
            }
        }
        else
        {
            matched = false;
        }

        if(matched)
        {
            matchedValues.push(currentPlace);
        }
    }
    
    console.log(matchedValues)

    DeleteAllButtons();
    for (let e = 0; e < matchedValues.length; e++) 
    {
        AddPlaceButton (matchedValues[e]);        
    }   
    
}

     let buttons = []

     function DeleteAllButtons()
     {
        for (let i = 0; i < buttons.length; i++) 
        {
            buttons[i].remove();    
        }

        buttons = []
     }

     function AddPlaceButton (selectedPlace)
     {
         let newButton = document.createElement("Button")
         dropDown.append(newButton);
         newButton.style.paddingTop = "3px";
         newButton.style.paddingBottom = "3px";
         newButton.style.color = "white";
         newButton.style.width = "100%";
         newButton.textContent = selectedPlace.key;
         newButton.onclick = () => {PlaceSelected(selectedPlace)}

         buttons.push(newButton);
     }

  
    async function PlaceSelected(selectedPlace)
     {        
        placeName.innerHTML = selectedPlace.key;
        // const data = await fetch(`https://api.weatherapi.com/v1/forecast.json?key=${key}&q=${selectedPlace.key}&days=7&aqi=no&alerts=no`)

        // console.log(data);

        const apiKey = '69d91b41f62e4140b46135934240508'; // Replace with your WeatherAPI key
        const location = selectedPlace.key; // Replace with the city you want the weather for

        // WeatherAPI 7-day forecast endpoint
        const url = `https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${location}&days=7`;

        // Fetch the weather data
        fetch(url)
            .then(response => response.json())
            .then(data => {
                // Process and display the data
                console.log(data);
               
                const forecastData = data.forecast.forecastday; // Array of daily forecast objects
            
                placeName.innerHTML = data.location.name;

                let currentTemperatureIcon = document.getElementById("currentTemperatureIcon");
                console.log(data.current.condition.icon)
                currentTemperatureIcon.src = data.current.condition.icon;

                let currentTemperature = document.getElementById("currentTemperature");
                console.log(data.current.temp_c)
                currentTemperature.innerHTML = `${data.current.temp_c}°C`;

                for (let i = 0; i < forecastData.length; i++) 
                {
                    let dayField = document.getElementById("Day"+(i+1));
                    let dateField = document.getElementById("Date"+(i+1));
                    
                    let dayIcon = document.getElementById("DayIcon"+(i+1));
                    let dateTemperatureRange = document.getElementById("DateTemperatureRange"+(i+1));

                    const placeTemperature = document.querySelectorAll(".temperatureDay"+(i+1))
                    const placeHour = document.querySelectorAll(".hourDay"+(i+1))
                    const hourIcon = document.querySelectorAll(".hourIcon"+(i+1))

                    let day = forecastData[i];

                    dayIcon.src = day.day.condition.icon;
                    dateTemperatureRange.innerHTML = `${day.day.mintemp_c}°C - ${day.day.maxtemp_c}°C` ;

                     //const date = new Date(day.date).toLocaleDateString(); // Date in human-readable format
                     const date = new Date(day.date);
                     // Example usage
                    //const date = '2024-08-05'; // Date in YYYY-MM-DD format
                    const dayOfWeek = getDayFromDate(date);
                    console.log(`${dayOfWeek}.`);
                  
                    const description = day.day.condition.text; // Weather description

                    dayField.innerHTML = dayOfWeek;
                    dateField.innerHTML = date.toLocaleDateString();
                    console.log(`Weather: ${description}`);
                
                    let hours = day.hour
                    for (let k = 0; k < hours.length; k++) 
                    {
                        placeTemperature[k].innerHTML = `${hours[k].temp_c}°C`;
                        placeHour[k].innerHTML = `${DisplayTime(hours[k].time)}`;
                        console.log(hourIcon[k]);
                        console.log(hourIcon[k].src);
                        hourIcon[k].src = `${hours[k].condition.icon}`;
                        console.log(hourIcon[k].src);
                        placeTemperature[k].append(hourIcon[k])
                    }
                   
                    console.log('----------------------');
                }
<<<<<<< HEAD
                // forecastData.forEach(day => {
                   
                // });
=======
              
>>>>>>> 1aac80a (Weather On React Added)
            })
            .then(()=>
            {
                temperatureDiv.style.visibility = 'visible';
            })
            .catch(error => console.error('Error fetching the weather data:', error));

     }

     function getDayFromDate(dateString) {
        const date = new Date(dateString); // Create a Date object from the date string
        const options = { weekday: 'long' }; // Format option for full weekday name
        const dayOfWeek = new Intl.DateTimeFormat('en-US', options).format(date); // Get the day name
        return dayOfWeek;
    }
    
    function DisplayTime(dateTimeString) 
    {
        // Split the datetime string to extract the time part
        const time = dateTimeString.split(' ')[1];
        return time;
        
    }
    